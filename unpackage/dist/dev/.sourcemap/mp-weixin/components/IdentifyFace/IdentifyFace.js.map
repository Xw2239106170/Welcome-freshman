{"version":3,"sources":["webpack:///D:/XBuilder/uni-welcome-service/components/IdentifyFace/IdentifyFace.vue?3ebd","webpack:///D:/XBuilder/uni-welcome-service/components/IdentifyFace/IdentifyFace.vue?0982","webpack:///D:/XBuilder/uni-welcome-service/components/IdentifyFace/IdentifyFace.vue?de21","webpack:///D:/XBuilder/uni-welcome-service/components/IdentifyFace/IdentifyFace.vue?f775","uni-app:///components/IdentifyFace/IdentifyFace.vue","webpack:///D:/XBuilder/uni-welcome-service/components/IdentifyFace/IdentifyFace.vue?9687","webpack:///D:/XBuilder/uni-welcome-service/components/IdentifyFace/IdentifyFace.vue?f24b"],"names":["name","computed","data","defaultPic","isRead","photo","img","similarity","show","onReady","methods","judgePerson","uni","image1","xuehao","csc","upload","quality","success","console","wx","url","filePath","fail","title","mask","setTimeout","changeRadio","watch"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyH;AACzH;AACgE;AACL;AACc;;;AAGzE;AACkN;AAClN,gBAAgB,4NAAU;AAC1B,EAAE,kFAAM;AACR,EAAE,uFAAM;AACR,EAAE,gGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,2FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAo1B,CAAgB,i2BAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACkCx2B;AAGA;AAAA;AAAA,eAEA;EACAA;EACAC,4BACA,wDACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;EACA;EACAC,yCACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACAC;kBACAC;kBACAC;gBACA;cAAA;gBAHAC;gBAAA,iCAIAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBAAA,kCACAJ;cAAA;gBAEA;kBACAK;kBACAC;oBACA;oBACAC;oBACA;oBACA;oBACAC;sBACAC;sBAAA;sBACAC;sBAAA;sBACAtB;sBAAA;sBACA;sBAAA;sBACAkB;wBAAA;wBACA;wBACA;wBACAC;wBACA;wBACA;wBACA;wBACA;wBACA;wBACA;0BACAN;0BACAC;wBACA;wBACAC;0BACA;0BACA;0BACA;4BACA;4BACAH;4BACAA;8BACAS;4BACA;4BACA;0BACA;4BACA;4BACA;0BACA;wBACA;sBACA;sBACAE;wBACA;wBACAJ;sBACA;oBACA;kBACA;kBACAI;oBACAJ;kBACA;gBACA;gBACA;gBACAP;gBACAA;kBACAY;kBACAC;gBACA;gBACAC;kBACAd;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACAe;MACA;IACA;EAAA,EACA;EACAC;IACAvB;MACA;MACA;MACAc;IACA;EACA;AAEA;AAAA,2B;;;;;;;;;;;;;AChJA;AAAA;AAAA;AAAA;AAA2jD,CAAgB,4gDAAG,EAAC,C;;;;;;;;;;;ACA/kD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/IdentifyFace/IdentifyFace.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./IdentifyFace.vue?vue&type=template&id=7ee47824&\"\nvar renderjs\nimport script from \"./IdentifyFace.vue?vue&type=script&lang=js&\"\nexport * from \"./IdentifyFace.vue?vue&type=script&lang=js&\"\nimport style0 from \"./IdentifyFace.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/IdentifyFace/IdentifyFace.vue\"\nexport default component.exports","export * from \"-!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./IdentifyFace.vue?vue&type=template&id=7ee47824&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./IdentifyFace.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./IdentifyFace.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"container\">\r\n    <view class=\"face-box\">\r\n      <!--      <view class=\"face-top\">\r\n        <image :src=\"faceImage || defaultPic\" mode=\"aspectFill\" class=\"face-image\"></image>\r\n      </view> -->\r\n      <camera id=\"camera\" style=\"width: 100%; height: 300px;\" class=\"face-top\" device-position=\"front\" v-if=\"!photo\">\r\n      </camera>\r\n      <image :src=\"photo\" mode=\"aspectFill\" style=\"width: 100%; height: 300px;\" v-else></image>\r\n\r\n\r\n      <button @click=\"upload\" class=\"upload-button\" :disabled=\"photo\">\r\n        <image src=\"../../static/center2/photo.png\" mode=\"\" class=\"upload-icon\"></image>上传人脸\r\n      </button>\r\n    </view>\r\n    <view class=\"face-bottom\">\r\n      <radio :checked=\"isRead\" @click=\"changeRadio\"></radio>\r\n      <text>\r\n        <text style=\"color: #D8B774; font-size: 18px;\">我已阅读并同意使用协议</text>\r\n      </text>\r\n      <h1 style=\"color: red; font-size: 18px; margin-top: 20rpx;\">人脸采集注意事项：</h1>\r\n      <view class=\"bottom-item\">\r\n        <text>1、请勿对着照片拍照，即使通过验证也无法使用；</text>\r\n        <text>2、摘下眼镜、梳起刘海、露出双耳</text>\r\n        <text>3、表情正常，正面照，面部占整个照片的3/4;</text>\r\n        <text>4、光线充足，照片清晰;</text>\r\n        <text>5、纯色背景（推荐蓝底或红底）;</text>\r\n        <text>6、苹果系统需要横屏拍照</text>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\n  import {\r\n    mapState,\r\n    mapMutations\r\n  } from 'vuex';\r\n\r\n  export default {\r\n    name: \"IdentifyFace\",\r\n    computed: {\r\n      ...mapState('user', ['faceImage', 'userPhoto'])\r\n    },\r\n    data() {\r\n      return {\r\n        defaultPic: '/static/center2/avatar.png',\r\n        isRead: false,\r\n        photo: uni.getStorageSync('userPhoto') || '',\r\n        img: '',\r\n        similarity: 0,\r\n        show: true\r\n      };\r\n    },\r\n    onReady() {\r\n      this.cameraContext = wx.createCameraContext();\r\n    },\r\n    methods: {\r\n      ...mapMutations('user', ['getFaceImage', 'getUserPhoto']),\r\n      async judgePerson(image) {\r\n        const csc = await uni.$http.get('/stu', {\r\n          image1: this.img,\r\n          xuehao: '2212040252'\r\n        })\r\n        return csc\r\n      },\r\n      async upload() {\r\n        if (!this.isRead) {\r\n          return uni.$showMsg('请勾选阅读协议！')\r\n        }\r\n        this.cameraContext.takePhoto({\r\n          quality: 'high',\r\n          success: (res) => {\r\n            // this.photo = res.tempImagePath\r\n            console.log('拍照成功', res.tempImagePath);\r\n            // this.img = res.tempImagePath\r\n            // 上传图片\r\n            wx.uploadFile({\r\n              url: 'http://192.168.14.54:8080/upload', // 上传接口地址\r\n              filePath: res.tempImagePath, // 使用res.tempImagePath\r\n              name: 'file', // 服务器接收的文件字段名\r\n              'image': res.tempImagePath, // 其他请求参数\r\n              success: function(res) {\r\n                var data = res.data\r\n                // 上传成功后的处理逻辑\r\n                console.log(res)\r\n                // console.log(res.data);\r\n                let responseString = `${res.data}`;\r\n                let responseObject = JSON.parse(responseString);\r\n                this.img = responseObject.data;\r\n                // console.log('img' + this.img)\r\n                const csc = uni.$http.get('/stu', {\r\n                  image1: this.img,\r\n                  xuehao: '2212040252'\r\n                })\r\n                csc.then(data => {\r\n                  let response = JSON.parse(data.data.data)\r\n                  this.similarity = response.score\r\n                  if (this.similarity > 0.67) {\r\n                    this.photo = this.img\r\n                    uni.setStorageSync('userPhoto', this.photo)\r\n                    uni.navigateTo({\r\n                      url: '/subpkg/persondetail/persondetail?id=' + 1\r\n                    })\r\n                    return uni.$showMsg(`验证成功~`)\r\n                  } else {\r\n                    this.photo = ''\r\n                    return uni.$showMsg(`验证不成功哦~`)\r\n                  }\r\n                }, )\r\n              },\r\n              fail: function(err) {\r\n                // 上传失败后的处理逻辑\r\n                console.log('上传失败', err);\r\n              }\r\n            });\r\n          },\r\n          fail: (err) => {\r\n            console.log('拍照失败', err);\r\n          }\r\n        });\r\n        this.getUserPhoto(this.photo)\r\n        uni.$showMsg('上传成功，审核需等待几分钟哦~')\r\n        uni.showLoading({\r\n          title: '人脸比对中~',\r\n          mask: true\r\n        })\r\n        setTimeout(() => {\r\n          uni.hideLoading()\r\n          // uni.$showMsg('审核通过！！')\r\n        }, 5000);\r\n      },\r\n      changeRadio() {\r\n        this.isRead = true\r\n      },\r\n    },\r\n    watch: {\r\n      photo(newVal, oldVal) {\r\n        // 在photo变化时执行逻辑\r\n        this.getUserPhoto(newVal)\r\n        console.log('photo 发生变化', newVal);\r\n      }\r\n    },\r\n\r\n  };\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n  .container {\r\n    padding: 20rpx;\r\n    background-color: #f5f5f5;\r\n  }\r\n\r\n  .face-box {\r\n    background-color: #fff;\r\n    border-radius: 10rpx;\r\n    padding: 20rpx;\r\n    box-shadow: 0 2rpx 4rpx rgba(0, 0, 0, 0.1);\r\n  }\r\n\r\n  .face-top {\r\n    height: 500rpx;\r\n    width: 100%;\r\n    text-align: center;\r\n    margin-bottom: 20rpx;\r\n  }\r\n\r\n  .face-image {\r\n    width: 400rpx;\r\n    height: 400rpx;\r\n    border-radius: 50%;\r\n  }\r\n\r\n  .upload-button {\r\n    background-color: #007aff;\r\n    color: #fff;\r\n    border: none;\r\n    padding: 10rpx 20rpx;\r\n    border-radius: 5rpx;\r\n    cursor: pointer;\r\n    font-size: 14px;\r\n    height: 100rpx;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n  }\r\n\r\n  .upload-icon {\r\n    width: 40rpx;\r\n    height: 40rpx;\r\n    margin-right: 10rpx;\r\n  }\r\n\r\n  .face-bottom {\r\n    margin-top: 20rpx;\r\n    width: 100%;\r\n\r\n    .bottom-item {\r\n      display: flex;\r\n      flex-direction: column;\r\n      margin-left: 20rpx;\r\n      margin-top: 10rpx;\r\n\r\n      text {\r\n        margin-bottom: 10rpx;\r\n        color: red;\r\n      }\r\n    }\r\n  }\r\n\r\n  /* 可以继续添加其他样式 */\r\n</style>","import mod from \"-!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./IdentifyFace.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./IdentifyFace.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1715063034736\n      var cssReload = require(\"D:/LenovoSoftstore/HBuilderX.4.0.2024012711-alpha/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}