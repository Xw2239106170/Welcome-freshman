<view class="calendar-page"><view class="nav-bar"><view data-event-opts="{{[['tap',[['goBack',['$event']]]]]}}" class="nav-back" bindtap="__e"><text class="back-icon">←</text></view><view class="nav-title">校历</view><view class="nav-action"><text data-event-opts="{{[['tap',[['downloadCalendar',['$event']]]]]}}" class="action-icon" bindtap="__e">⭳</text></view></view><view class="semester-select"><picker mode="selector" range="{{yearList}}" data-event-opts="{{[['change',[['onYearChange',['$event']]]]]}}" bindchange="__e"><view class="year-picker">{{''+currentYear+'学年'}}<text class="picker-arrow">▼</text></view></picker><view class="semester-tabs"><block wx:for="{{semesters}}" wx:for-item="sem" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['changeSemester',['$0'],[[['semesters','',index,'value']]]]]]]}}" class="{{['semester-tab',[(currentSemester===sem.value)?'active':'']]}}" bindtap="__e">{{''+sem.label+''}}</view></block></view></view><scroll-view class="calendar-content" scroll-y="{{true}}"><view class="overview-card"><view class="card-title">学期概览</view><view class="date-item"><text class="date-label">学期开始</text><text class="date-value">{{semesterInfo.startDate}}</text></view><view class="date-item"><text class="date-label">学期结束</text><text class="date-value">{{semesterInfo.endDate}}</text></view><view class="date-item"><text class="date-label">教学周数</text><text class="date-value">{{semesterInfo.totalWeeks+"周"}}</text></view></view><view class="important-dates"><view class="card-title">重要日期</view><block wx:for="{{importantDates}}" wx:for-item="event" wx:for-index="index" wx:key="index"><view class="event-item"><view class="event-date"><text class="date-month">{{event.month}}</text><text class="date-day">{{event.day}}</text></view><view class="event-info"><text class="event-name">{{event.name}}</text><text class="event-desc">{{event.description}}</text></view></view></block></view><view class="week-calendar"><view class="card-title">教学周历</view><block wx:for="{{$root.l0}}" wx:for-item="week" wx:for-index="index" wx:key="index"><view class="week-item"><view class="week-header"><text class="week-name">{{"第"+week.$orig.week+"周"}}</text><text class="week-date">{{week.$orig.startDate+" - "+week.$orig.endDate}}</text></view><block wx:if="{{week.g0}}"><view class="week-events"><block wx:for="{{week.$orig.events}}" wx:for-item="event" wx:for-index="eventIndex" wx:key="eventIndex"><view class="week-event-item"><text class="event-tag" style="{{'background-color:'+(event.tagColor)+';'}}">{{event.tag}}</text><text class="event-title">{{event.title}}</text></view></block></view></block></view></block></view><view class="calendar-legend"><view class="card-title">图示说明</view><view class="legend-list"><view class="legend-item"><view class="legend-color" style="background-color:#FF9800;"></view><text class="legend-text">课程时间</text></view><view class="legend-item"><view class="legend-color" style="background-color:#4CAF50;"></view><text class="legend-text">考试周</text></view><view class="legend-item"><view class="legend-color" style="background-color:#2196F3;"></view><text class="legend-text">实践周</text></view><view class="legend-item"><view class="legend-color" style="background-color:#9C27B0;"></view><text class="legend-text">假期</text></view></view></view></scroll-view></view>